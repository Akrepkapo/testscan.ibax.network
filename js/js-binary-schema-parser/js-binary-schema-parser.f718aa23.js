const e=(e,t)=>(r,o,a,n)=>{t(r,o,a)&&n(r,e,o,a)},t=e=>({data:e,pos:0}),r=(e=0)=>t=>t.data[t.pos+e],o=e=>t=>t.data.subarray(t.pos,t.pos+=e),a=e=>t=>t.data.subarray(t.pos,t.pos+e),n=e=>t=>Array.from(o(e)(t)).map((e=>String.fromCharCode(e))).join(""),s=e=>t=>{const r=o(2)(t);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]},i=(e,t)=>(r,a,n)=>{const s="function"==typeof t?t(r,a,n):t,i=o(e),d=new Array(s);for(var p=0;p<s;p++)d[p]=i(r);return d},d=e=>t=>{const r=(e=>e.data[e.pos++])(t),o=new Array(8);for(var a=0;a<8;a++)o[7-a]=!!(r&1<<a);return Object.keys(e).reduce(((t,r)=>{const a=e[r];return a.length?t[r]=((e,t,r)=>{for(var o=0,a=0;a<r;a++)o+=e[t+a]&&2**(r-a-1);return o})(o,a.index,a.length):t[r]=o[a.index],t}),{})};var p={blocks:e=>{const t=[],r=e.data.length;for(var a=0,n=(e=>e.data[e.pos++])(e);0!==n&&n;n=(e=>e.data[e.pos++])(e)){if(e.pos+n>=r){const n=r-e.pos;t.push(o(n)(e)),a+=n;break}t.push(o(n)(e)),a+=n}const s=new Uint8Array(a);for(var i=0,d=0;d<t.length;d++)s.set(t[d],i),i+=t[d].length;return s}};const c=e({gce:[{codes:o(2)},{byteSize:e=>e.data[e.pos++]},{extras:d({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:s(!0)},{transparentColorIndex:e=>e.data[e.pos++]},{terminator:e=>e.data[e.pos++]}]},(e=>{var t=a(2)(e);return 33===t[0]&&249===t[1]})),l=e({image:[{code:e=>e.data[e.pos++]},{descriptor:[{left:s(!0)},{top:s(!0)},{width:s(!0)},{height:s(!0)},{lct:d({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},e({lct:i(3,((e,t,r)=>Math.pow(2,r.descriptor.lct.size+1)))},((e,t,r)=>r.descriptor.lct.exists)),{data:[{minCodeSize:e=>e.data[e.pos++]},p]}]},(e=>44===r()(e))),u=e({text:[{codes:o(2)},{blockSize:e=>e.data[e.pos++]},{preData:(e,t,r)=>o(r.text.blockSize)(e)},p]},(e=>{var t=a(2)(e);return 33===t[0]&&1===t[1]})),f=e({application:[{codes:o(2)},{blockSize:e=>e.data[e.pos++]},{id:(e,t,r)=>n(r.blockSize)(e)},p]},(e=>{var t=a(2)(e);return 33===t[0]&&255===t[1]})),h=e({comment:[{codes:o(2)},p]},(e=>{var t=a(2)(e);return 33===t[0]&&254===t[1]})),x=[{header:[{signature:n(3)},{version:n(3)}]},{lsd:[{width:s(!0)},{height:s(!0)},{gct:d({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:e=>e.data[e.pos++]},{pixelAspectRatio:e=>e.data[e.pos++]}]},e({gct:i(3,((e,t)=>Math.pow(2,t.lsd.gct.size+1)))},((e,t)=>t.lsd.gct.exists)),{frames:(g=[c,f,h,l,u],v=e=>{var t=r()(e);return 33===t||44===t},(e,t,r,o)=>{const a=[];let n=e.pos;for(;v(e,t,r);){const r={};if(o(e,g,t,r),e.pos===n)break;n=e.pos,a.push(r)}return a})}];var g,v,y={};Object.defineProperty(y,"__esModule",{value:!0}),y.loop=y.conditional=y.parse=void 0;var b=y.parse=function e(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o;if(Array.isArray(r))r.forEach((function(r){return e(t,r,o,a)}));else if("function"==typeof r)r(t,o,a,e);else{var n=Object.keys(r)[0];Array.isArray(r[n])?(a[n]={},e(t,r[n],o,a[n])):a[n]=r[n](t,o,a,e)}return o};y.conditional=function(e,t){return function(r,o,a,n){t(r,o,a)&&n(r,e,o,a)}};y.loop=function(e,t){return function(r,o,a,n){for(var s=[],i=r.pos;t(r,o,a);){var d={};if(n(r,e,o,d),r.pos===i)break;i=r.pos,s.push(d)}return s}};export{t as b,b as p,x as s};
