var e=Math.pow;const t=(e,t)=>(r,o,a,n)=>{t(r,o,a)&&n(r,e,o,a)},r=e=>({data:e,pos:0}),o=(e=0)=>t=>t.data[t.pos+e],a=e=>t=>t.data.subarray(t.pos,t.pos+=e),n=e=>t=>t.data.subarray(t.pos,t.pos+e),s=e=>t=>Array.from(a(e)(t)).map((e=>String.fromCharCode(e))).join(""),i=e=>t=>{const r=a(2)(t);return e?(r[1]<<8)+r[0]:(r[0]<<8)+r[1]},d=(e,t)=>(r,o,n)=>{const s="function"==typeof t?t(r,o,n):t,i=a(e),d=new Array(s);for(var p=0;p<s;p++)d[p]=i(r);return d},p=t=>r=>{const o=(e=>e.data[e.pos++])(r),a=new Array(8);for(var n=0;n<8;n++)a[7-n]=!!(o&1<<n);return Object.keys(t).reduce(((r,o)=>{const n=t[o];return n.length?r[o]=((t,r,o)=>{for(var a=0,n=0;n<o;n++)a+=t[r+n]&&e(2,o-n-1);return a})(a,n.index,n.length):r[o]=a[n.index],r}),{})};var c={blocks:e=>{const t=[],r=e.data.length;for(var o=0,n=(e=>e.data[e.pos++])(e);0!==n&&n;n=(e=>e.data[e.pos++])(e)){if(e.pos+n>=r){const n=r-e.pos;t.push(a(n)(e)),o+=n;break}t.push(a(n)(e)),o+=n}const s=new Uint8Array(o);for(var i=0,d=0;d<t.length;d++)s.set(t[d],i),i+=t[d].length;return s}};const l=t({gce:[{codes:a(2)},{byteSize:e=>e.data[e.pos++]},{extras:p({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:i(!0)},{transparentColorIndex:e=>e.data[e.pos++]},{terminator:e=>e.data[e.pos++]}]},(e=>{var t=n(2)(e);return 33===t[0]&&249===t[1]})),u=t({image:[{code:e=>e.data[e.pos++]},{descriptor:[{left:i(!0)},{top:i(!0)},{width:i(!0)},{height:i(!0)},{lct:p({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},t({lct:d(3,((e,t,r)=>Math.pow(2,r.descriptor.lct.size+1)))},((e,t,r)=>r.descriptor.lct.exists)),{data:[{minCodeSize:e=>e.data[e.pos++]},c]}]},(e=>44===o()(e))),f=t({text:[{codes:a(2)},{blockSize:e=>e.data[e.pos++]},{preData:(e,t,r)=>a(r.text.blockSize)(e)},c]},(e=>{var t=n(2)(e);return 33===t[0]&&1===t[1]})),h=t({application:[{codes:a(2)},{blockSize:e=>e.data[e.pos++]},{id:(e,t,r)=>s(r.blockSize)(e)},c]},(e=>{var t=n(2)(e);return 33===t[0]&&255===t[1]})),x=t({comment:[{codes:a(2)},c]},(e=>{var t=n(2)(e);return 33===t[0]&&254===t[1]})),g=[{header:[{signature:s(3)},{version:s(3)}]},{lsd:[{width:i(!0)},{height:i(!0)},{gct:p({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:e=>e.data[e.pos++]},{pixelAspectRatio:e=>e.data[e.pos++]}]},t({gct:d(3,((e,t)=>Math.pow(2,t.lsd.gct.size+1)))},((e,t)=>t.lsd.gct.exists)),{frames:(v=[l,h,x,u,f],y=e=>{var t=o()(e);return 33===t||44===t},(e,t,r,o)=>{const a=[];let n=e.pos;for(;y(e,t,r);){const r={};if(o(e,v,t,r),e.pos===n)break;n=e.pos,a.push(r)}return a})}];var v,y,b={};Object.defineProperty(b,"__esModule",{value:!0}),b.loop=b.conditional=b.parse=void 0;var k=b.parse=function e(t,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o;if(Array.isArray(r))r.forEach((function(r){return e(t,r,o,a)}));else if("function"==typeof r)r(t,o,a,e);else{var n=Object.keys(r)[0];Array.isArray(r[n])?(a[n]={},e(t,r[n],o,a[n])):a[n]=r[n](t,o,a,e)}return o};b.conditional=function(e,t){return function(r,o,a,n){t(r,o,a)&&n(r,e,o,a)}};b.loop=function(e,t){return function(r,o,a,n){for(var s=[],i=r.pos;t(r,o,a);){var d={};if(n(r,e,o,d),r.pos===i)break;i=r.pos,s.push(d)}return s}};export{r as b,k as p,g as s};
